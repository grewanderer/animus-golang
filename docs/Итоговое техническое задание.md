# Animus Datalab — Итоговое техническое задание (Production‑Grade)

## 0. Назначение документа

Данный документ является **итоговым, консолидированным ТЗ** на доведение существующего frame Animus Datalab до **production‑grade платформы**, способной **полностью заменить разрозненный стек инструментов ML‑разработчиков** в корпоративной среде.

Документ предназначен для:

* реализации (Codex / инженерные команды),
* архитектурного и security‑review,
* эксплуатации (platform / SRE),
* управленческого контроля объёма и готовности.

Документ фиксирует **целевое состояние системы**, а не текущее.

---

## 1. Цели и границы

### 1.1 Цель платформы

Animus — это **основная рабочая среда ML‑разработчика**, покрывающая полный жизненный цикл:

**данные → эксперименты → модели → подготовка к production**,

в едином контексте, с воспроизводимостью, безопасностью и корпоративной управляемостью по умолчанию.

### 1.2 Принципиальная позиция

* Animus **заменяет модель работы**, а не просто инструменты.
* Нет «магии за кадром» — все действия и зависимости явны.
* Безопасность и аудит — свойства системы, а не надстройки.
* Интеграции предпочтительнее переписывания существующих систем.

### 1.3 Вне рамок (явно)

* Собственный Git / IDE
* Полноценная inference‑платформа (допускается экспорт)
* Feature Store как отдельный продукт (допускаются интерфейсы)

---

## 2. Архитектурная модель

### 2.1 Разделение плоскостей

**Control Plane**

* API
* Метаданные
* Оркестрация
* Политики доступа
* Аудит

**Data Plane**

* Исполнение пользовательского кода
* Работа с данными и артефактами
* Изолированные run‑окружения

Control Plane **никогда** не исполняет пользовательский код.

### 2.2 Базовый runtime

* Kubernetes — обязательный baseline
* Поддержка:

  * single‑cluster
  * multi‑cluster readiness
  * air‑gapped окружений

---

## 3. Доменная модель (обязательные сущности)

### 3.1 Project

* Строгая граница изоляции ML‑продукта
* Содержит все остальные сущности
* Нет скрытых зависимостей между Project

### 3.2 Dataset / DatasetVersion

* Dataset — первоклассный объект
* DatasetVersion — **immutable**
* Явное версионирование
* Метаданные:

  * схема
  * источник
  * статистики
  * lineage

### 3.3 Run / PipelineRun

* Единица исполнения
* Связи:

  * Project
  * DatasetVersion
  * CodeRef
  * Artifacts

### 3.4 Artifact

* Логи, метрики, файлы, модели
* Хранение в object storage
* Управляемый lifecycle

### 3.5 Model

* Версионируемый объект
* Статусы:

  * draft
  * validated
  * approved
  * deprecated

### 3.6 AuditEvent

* Append‑only
* Неизменяемый
* Экспортируемый

---

## 4. Developer Toolchain (целевой перечень инструментов)

Animus **обязан** закрывать следующий набор инструментов разработчика.

### 4.1 Разработка

* Managed notebooks
* Interactive terminals
* Remote IDE (VS Code / JetBrains via SSH/HTTP)
* Dev environment templates (CPU/GPU)

### 4.2 Управление окружениями

* Явные environment definitions
* Lock‑файлы
* Проверка immutability для production‑run

### 4.3 Эксперименты

* Experiment tracking
* Метрики / параметры / артефакты
* Сравнение run’ов
* Теги и фильтрация

### 4.4 Оркестрация

* Декларативные pipeline specs
* Dependency graph
* Очереди, приоритеты, ретраи

### 4.5 Данные

* Dataset registry
* Версии и схемы
* Политики доступа

### 4.6 Модели

* Model registry
* Promotion workflow
* Экспорт во внешние системы

### 4.7 Governance

* Audit
* Retention
* Compliance hooks

---

## 5. Интеграции (обязательная матрица)

### 5.1 Git / SCM

* GitHub / GitLab / Bitbucket / on‑prem
* CodeRef:

  * repo_url
  * commit_sha (обязателен)
* Production‑run **только по commit SHA**
* Секреты доступа — только на время run

### 5.2 CI/CD

* Webhook‑интеграции
* Events:

  * RunFinished
  * ModelApproved
  * DatasetVersionCreated

### 5.3 Container Registry

* Pull/push образов
* Подпись и хеши (желательно)

### 5.4 Identity & Access

* OIDC / SAML
* IdP groups → Project roles
* Service accounts

### 5.5 Secrets Management

* Vault‑like интеграция
* Временные секреты
* UI не раскрывает значения

### 5.6 Storage

* S3‑compatible object storage
* Read‑only источники
* Write‑through для артефактов

### 5.7 Observability / SIEM

* Prometheus / OpenTelemetry
* Audit export (syslog/webhook)

---

## 6. Безопасность (обязательный минимум)

### 6.1 Принципы

* Zero‑trust
* Least privilege
* Явные политики

### 6.2 Аутентификация

* SSO
* Session TTL
* Forced logout
* Ограничение параллельных сессий

### 6.3 Авторизация

* RBAC на Project
* Уточнение на Dataset / Run / Model

### 6.4 Секреты

* Не хранятся в логах
* Не отображаются в UI
* Доступны только во время исполнения

### 6.5 Аудит

* Все действия фиксируются
* Нельзя отключить

---

## 7. Эксплуатационная готовность

### 7.1 Надёжность

* HA Control Plane
* Идемпотентность операций
* Retry / backoff

### 7.2 Observability

* Метрики
* Логи (structured)
* Tracing

### 7.3 Backup & DR

* Backup метаданных
* RPO / RTO заданы
* Процедуры восстановления

### 7.4 Governance данных

* Retention policies
* Secure deletion
* Legal hold (если требуется)

---

## 8. CI/CD и качество

* Lint
* Unit tests
* Integration tests
* E2E: git → run → artifacts → model promotion
* Security scanning
* SBOM

---

## 9. Деплой и поставка

* Helm / Kustomize
* External DB support
* Air‑gapped install
* Upgrade / rollback

---

## 10. Acceptance Criteria (итоговые)

Платформа считается production‑grade, если:

1. Весь ML‑цикл проходит в одном Project без внешней ручной склейки.
2. Любой run воспроизводим по данным + commit SHA + environment.
3. Все действия аудитируются и экспортируемы.
4. SSO + RBAC работают end‑to‑end.
5. Установка и обновление документированы и автоматизируемы.
6. Нет неявного состояния и скрытых зависимостей.

---

## 11. Итог

Animus в этом ТЗ — это **не MLOps‑инструмент**, а **корпоративная ML‑операционная система**, способная заменить текущий стек инструментов и масштабироваться организационно, технически и регуляторно.
